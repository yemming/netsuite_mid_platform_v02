# 地圖服務方案選擇指南

## 目前實作方案：Leaflet + OpenStreetMap ✅

**優點：**
- ✅ 完全免費，不需要 API key
- ✅ 開源，穩定可靠
- ✅ 在台灣可用，無需翻牆
- ✅ 功能完整，支援標記、彈出視窗等
- ✅ 可自訂樣式

**缺點：**
- ⚠️ 地圖資料可能不如 Google Maps 詳細
- ⚠️ 需要自行處理地理編碼（地址轉座標）

**使用方式：**
已整合到 `components/field-operations/map-view.tsx`，可直接使用。

---

## 其他可選方案

### 1. Google Maps JavaScript API

**優點：**
- ✅ 地圖資料最詳細
- ✅ 功能強大（路線規劃、地理編碼等）
- ✅ 有免費額度（每月 $200 免費額度）

**缺點：**
- ❌ 需要 API key 和信用卡
- ❌ 超過免費額度需付費
- ❌ 在中國大陸無法使用

**實作方式：**
```bash
npm install @react-google-maps/api
```

**設定步驟：**
1. 前往 [Google Cloud Console](https://console.cloud.google.com/)
2. 建立專案並啟用 Maps JavaScript API
3. 建立 API key
4. 設定環境變數：`NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_key`

**程式碼範例：**
```tsx
import { GoogleMap, LoadScript, Marker } from '@react-google-maps/api';

<LoadScript googleMapsApiKey={process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY!}>
  <GoogleMap
    center={{ lat: 25.0330, lng: 121.5654 }}
    zoom={12}
  >
    <Marker position={{ lat: 25.0330, lng: 121.5654 }} />
  </GoogleMap>
</LoadScript>
```

---

### 2. TGOS MAP API Lite（台灣內政部）

**優點：**
- ✅ 台灣官方提供，完全免費
- ✅ 無需註冊即可使用
- ✅ 適合台灣地區使用
- ✅ 提供靜態地圖嵌入

**缺點：**
- ⚠️ 功能較簡單（主要是靜態地圖）
- ⚠️ 互動功能有限

**使用方式：**
```html
<iframe 
  src="https://api.tgos.nat.gov.tw/TGOS_MAP_API/WebService/TileHandler.ashx?version=1.0.0&x={x}&y={y}&z={z}"
  width="800" 
  height="400"
/>
```

**文件：**
- [TGOS MAP API 文件](https://data.gov.tw/dataset/31960)

---

### 3. Map8（台灣圖霸）

**優點：**
- ✅ 台灣本地服務
- ✅ 與 Google Maps 相容
- ✅ 提供完整 API（地圖、搜尋、路線規劃）
- ✅ 有免費方案

**缺點：**
- ⚠️ 需要註冊和 API key
- ⚠️ 免費方案有限制

**網站：**
- [Map8 官網](https://www.map8.zone/)

---

### 4. Mapbox

**優點：**
- ✅ 美觀的地圖樣式
- ✅ 有免費額度（每月 50,000 次載入）
- ✅ 功能完整
- ✅ 可高度自訂

**缺點：**
- ❌ 需要 API key 和註冊
- ❌ 超過免費額度需付費

**實作方式：**
```bash
npm install react-map-gl mapbox-gl
```

**設定步驟：**
1. 前往 [Mapbox](https://www.mapbox.com/) 註冊
2. 取得 Access Token
3. 設定環境變數：`NEXT_PUBLIC_MAPBOX_TOKEN=your_token`

---

### 5. Here Maps

**優點：**
- ✅ 有免費方案
- ✅ 功能完整
- ✅ 提供路線規劃、地理編碼等

**缺點：**
- ❌ 需要註冊和 API key
- ❌ 免費方案有限制

---

## 建議

### 開發階段
**使用 Leaflet + OpenStreetMap**（目前實作）
- 完全免費，無需設定
- 適合開發和測試

### 生產環境
根據需求選擇：

1. **如果預算有限且功能需求簡單**
   - 繼續使用 Leaflet + OpenStreetMap
   - 或使用 TGOS MAP API Lite

2. **如果需要詳細地圖和完整功能**
   - Google Maps（最詳細，但需要 API key）
   - Mapbox（美觀，有免費額度）

3. **如果專注台灣市場**
   - Map8（台灣本地服務）
   - TGOS（台灣官方服務）

---

## 切換地圖服務

如果要切換到其他地圖服務，只需要：

1. 安裝對應的套件
2. 建立新的地圖組件（參考 `components/field-operations/map-view.tsx`）
3. 在 `dispatch/page.tsx` 中替換 `MapView` 組件

所有地圖組件都應該接受相同的 props：
- `center`: [lat, lng]
- `zoom`: number
- `technicianLocations`: TechnicianLocation[]
- `workOrderLocations`: WorkOrderLocation[]

